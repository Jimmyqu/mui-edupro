<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		
		<link rel="stylesheet" href="../css/mui.min.css" />
		<link rel="stylesheet" href="../css/style.css" />
		<style>
			.mui-preview-image.mui-fullscreen {
                position: fixed;
                z-index: 20;
                background-color: #000;
            }
            .mui-preview-header,
            .mui-preview-footer {
                position: absolute;
                width: 100%;
                left: 0;
                z-index: 10;
            }
            .mui-preview-header {
                height: 44px;
                top: 0;
            }
            .mui-preview-footer {
                height: 50px;
                bottom: 0px;
            }
            .mui-preview-header .mui-preview-indicator {
                display: block;
                line-height: 25px;
                color: #fff;
                text-align: center;
                margin: 15px auto 4;
                width: 70px;
                background-color: rgba(0, 0, 0, 0.4);
                border-radius: 12px;
                font-size: 16px;
            }
            .mui-preview-image {
                display: block;
                -webkit-animation-duration: 0.5s;
                animation-duration: 0.5s;
                -webkit-animation-fill-mode: both;
                animation-fill-mode: both;
            }
            .mui-preview-image.mui-preview-in {
                -webkit-animation-name: fadeIn;
                animation-name: fadeIn;
            }
            .mui-preview-image.mui-preview-out {
                background: none;
                -webkit-animation-name: fadeOut;
                animation-name: fadeOut;
            }
            .mui-preview-image.mui-preview-out .mui-preview-header,
            .mui-preview-image.mui-preview-out .mui-preview-footer {
                display: none;
            }
            .mui-zoom-scroller {
                position: absolute;
                display: -webkit-box;
                display: -webkit-flex;
                display: flex;
                -webkit-box-align: center;
                -webkit-align-items: center;
                align-items: center;
                -webkit-box-pack: center;
                -webkit-justify-content: center;
                justify-content: center;
                left: 0;
                right: 0;
                bottom: 0;
                top: 0;
                width: 100%;
                height: 100%;
                margin: 0;
                -webkit-backface-visibility: hidden;
            }
            .mui-zoom {
                -webkit-transform-style: preserve-3d;
                transform-style: preserve-3d;
            }
            .mui-slider .mui-slider-group .mui-slider-item img {
                width: auto;
                height: auto;
                max-width: 100%;
                max-height: 100%;
            }
            .mui-android-4-1 .mui-slider .mui-slider-group .mui-slider-item img {
                width: 100%;
            }
            .mui-android-4-1 .mui-slider.mui-preview-image .mui-slider-group .mui-slider-item {
                display: inline-table;
            }
            .mui-android-4-1 .mui-slider.mui-preview-image .mui-zoom-scroller img {
                display: table-cell;
                vertical-align: middle;
            }
            .mui-preview-loading {
                position: absolute;
                width: 100%;
                height: 100%;
                top: 0;
                left: 0;
                display: none;
            }
            .mui-preview-loading.mui-active {
                display: block;
            }
            .mui-preview-loading .mui-spinner-white {
                position: absolute;
                top: 50%;
                left: 50%;
                margin-left: -25px;
                margin-top: -25px;
                height: 50px;
                width: 50px;
            }
            .mui-preview-image img.mui-transitioning {
                -webkit-transition: -webkit-transform 0.5s ease, opacity 0.5s ease;
                transition: transform 0.5s ease, opacity 0.5s ease;
            }
            @-webkit-keyframes fadeIn {
                0% {
                    opacity: 0;
                }
                100% {
                    opacity: 1;
                }
            }
            @keyframes fadeIn {
                0% {
                    opacity: 0;
                }
                100% {
                    opacity: 1;
                }
            }
            @-webkit-keyframes fadeOut {
                0% {
                    opacity: 1;
                }
                100% {
                    opacity: 0;
                }
            }
            @keyframes fadeOut {
                0% {
                    opacity: 1;
                }
                100% {
                    opacity: 0;
                }
            }
            p img {
                max-width: 100%;
                height: auto;
            }           
            img {
                width: auto;
                max-width: 100%;
            }

			.img-container{
				background: #2AC845;
				width: 25%;
				height: 0;
				padding-bottom: 25%;
				border: 1px solid salmon;
			}
			#img-item{
				width: 100%;
				height: 100%;
			}
		</style>
	</head>
	<body>
		<div class="mui-content">
		    <ul class="mui-table-view mui-grid-view mui-grid-9">
		    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3">
		        <a href="#" id='test'>
		            <span class="mui-icon mui-icon-home"></span>
		            <div class="mui-media-body">Home</div>
		        </a>
		    </li>
		    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3">
		        <a href="#" id='pic'>
		            <span class="mui-icon mui-icon-email"><span class="mui-badge mui-badge-red">5</span></span>
		            <div class="mui-media-body">Email</div>
		        </a>
		    </li>
		    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3">
		        <a href="#">
		            <span class="mui-icon mui-icon-chatbubble"></span>
		            <div class="mui-media-body">Chat</div>
		        </a>
		    </li>
		    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3">
		        <a href="#">
		            <span class="mui-icon mui-icon-location"></span>
		            <div class="mui-media-body">Location</div>
		        </a>
		    </li>
		    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3">
		        <a href="#">
		            <span class="mui-icon mui-icon-search"></span>
		            <div class="mui-media-body">Search</div>
		        </a>
		    </li>
		    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3">
		        <a href="#">
		            <span class="mui-icon mui-icon-phone"></span>
		            <div class="mui-media-body">Phone</div>
		        </a>
		    </li>
		</ul>
			<div class="img-container" >
				<img id='img-item' src="" alt="" />
			</div>
		    
		</div>
		
		
		<script src="../js/mui.min.js"></script>
		<script src="../js/mui.view.js"></script>
		<script>
			mui.init()
		
			mui.plusReady(function(){
				
				
				//拍照
		        function getImage() {
		            var c = plus.camera.getCamera();
		            console.log(222222)
		            c.captureImage(function(e) {
		                plus.io.resolveLocalFileSystemURL(e, function(entry) {
		                    var s = entry.toLocalURL() + "?version=" + new Date().getTime();
		                    console.log("imgPath = "+s)
		                    	
		                		mui('#img-item')[0].src=s
		                    //uploadHead(s); /*上传图片*/
		                }, function(e) {
		                    console.log("读取拍照文件错误：" + e.message);
		                });
		            }, function(s) {
		                console.log("error" + s);
		            }, {
		                filename: "_doc/head.png"
		            })
		        }
				
				//本地相册选择
		        function galleryImg() {
		            plus.gallery.pick(function(a) {
		            		console.log(1111111)
		                plus.io.resolveLocalFileSystemURL(a, function(entry) {
		                    plus.io.resolveLocalFileSystemURL("_doc/", function(root) {
		                        root.getFile("head.png", {}, function(file) {
		                            //文件已存在
		                            file.remove(function() {
		                                console.log("file remove success");
		                                entry.copyTo(root, 'head.png', function(e) {
		                                        var e = e.fullPath + "?version=" + new Date().getTime();
		                                        uploadHead(e); /*上传图片*/
		                                        //变更大图预览的src
		                                        //目前仅有一张图片，暂时如此处理，后续需要通过标准组件实现
		                                    },
		                                    function(e) {
		                                        console.log('copy image fail:' + e.message);
		                                    });
		                            }, function() {
		                                console.log("delete image fail:" + e.message);
		                            });
		                        }, function() {
		                            //文件不存在
		                            entry.copyTo(root, 'head.png', function(e) {
		                                    var path = e.fullPath + "?version=" + new Date().getTime();
		                                    uploadHead(path); /*上传图片*/
		                                },
		                                function(e) {
		                                    console.log('copy image fail:' + e.message);
		                                });
		                        });
		                    }, function(e) {
		                        console.log("get _www folder fail");
		                    })
		                }, function(e) {
		                    console.log("读取拍照文件错误：" + e.message);
		                });
		            }, function(a) {}, {
		                filter: "image"
		            })
		        };
				mui('#test')[0].addEventListener('tap',function(){
					 mui.openWindow({
				     url: '../secondsPage/homeChird.html',
				     id:'homeChird.html'
				  });
				})

				mui('#pic')[0].addEventListener('tap',function(){
					  if (mui.os.plus) {
		                var a = [{
		                    title: "拍照"
		                }, {
		                    title: "从手机相册选择"
		                }];
		                plus.nativeUI.actionSheet({
		                    title: "修改用户头像",
		                    cancel: "取消",
		                    buttons: a
		                }, function(b) { /*actionSheet 按钮点击事件*/
		                    switch (b.index) {
		                        case 0:
		                            break;
		                        case 1:
		                            getImage(); /*拍照*/
		                            break;
		                        case 2:
		                            galleryImg();/*打开相册*/
		                            break;
		                        default:
		                            break;
		                    }
		                })
		            }
				})
				
				
			})
		</script>
	</body>
</html>
